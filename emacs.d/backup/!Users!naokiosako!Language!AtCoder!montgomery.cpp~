#include<stdio.h>
//a*b mod Nを計算したい
#define RSA_N 169  //RSAのN
#define RSA_NINV 103  //RSAのN
// モンゴメリ演算に使われる定数シフトで計算するため2のなんとか乗にする
#define MONG_R 256
#define MONG_R2 133
#define MONG_RIND 8 //指数部分定数
//test 値適当
//モンゴメリ演算でa*b mod Nを計算
int mong(int a, int b);
int MR(int x);
int main (void){
    int ans = mong(11, 18);
    if(ans == 11*18 % RSA_N)
	printf("%d OK\n", ans);
    else
	printf("NOT\n");
    
    return 0;
}
int mong(int a, int b){
    int A = MR(a*MONG_R2);
    int B = MR(b*MONG_R2);
    return MR(MR(A*B));
}
int MR(int x){
    //一旦テストのためmodなどつかう
    //    return (x + (x * RSA_NINV % MONG_R) * RSA_N) / MONG_R;
    return (x + (x * RSA_NINV % MONG_R) * RSA_N) >> MONG_RIND;
}
